import{m as b,b as S,a as R,c as I,d as L}from"./vuex.esm-bundler.55d3d5b3.js";import"./default-i18n.0e8bc810.js";import{u as z,S as A}from"./SeoSiteScore.85505ada.js";import"./WpTable.3e09f0c1.js";import"./constants.e56e1512.js";import{_ as v,r as a,o as c,c as p,d as l,w as m,b as $,e as k,x as D,a as r,t as n,D as N,y,f as g,F as B,G as M}from"./_plugin-vue_export-helper.a81c6319.js";import"./index.4dbecc01.js";import{m as x}from"./helpers.51e5fd9c.js";import"./SaveChanges.c85e9ba4.js";import{C as P,a as V}from"./Score.6f21c5f3.js";import{p as F}from"./popup.b60b699f.js";import{C as G}from"./Blur.17ef7d02.js";import{C as T}from"./Card.0a3b54f8.js";import{C as W}from"./SeoSiteAnalysisResults.2180eb60.js";import{C as j}from"./Index.a9a2f84a.js";import{S as H}from"./Refresh.3396c34d.js";import{b as q}from"./index.fae5bbc8.js";import"./_commonjsHelpers.f84db168.js";import"./Index.3662e61b.js";import"./Caret.19bf2275.js";import"./Row.d42459be.js";import"./RequiresUpdate.52f5acf2.js";import"./postContent.f08c6962.js";import"./cleanForSlug.d16f1e3a.js";import"./html.a669733f.js";import"./Index.048705a6.js";import"./params.597cd0f5.js";import"./Tooltip.c4cc47a2.js";import"./Slide.4392623f.js";import"./GoogleSearchPreview.170d666f.js";import"./index.251e7289.js";import"./client.e7a26247.js";import"./Information.050096cc.js";import"./Gear.7e79093b.js";const J={setup(){const{strings:e}=z();return{strings:e}},components:{CoreBlur:G,CoreCard:T},mixins:[A],data(){return{score:0}},computed:{...b(["internalOptions"])},methods:{...S(["saveConnectToken"]),openPopup(e){F(e,this.connectWithAioseo,600,630,!0,["token"],this.completedCallback,()=>{})},completedCallback(e){return this.saveConnectToken(e.token)}}},Y={key:0,class:"aioseo-seo-site-score-cta"};function K(e,o,s,u,t,i){const d=a("core-card");return c(),p("div",null,[l(d,{slug:"analyzeNewCompetitor","hide-header":"","no-slide":"",toggles:!1},{default:m(()=>[(c(),$(D(e.internalOptions.internal.siteAnalysis.connectToken?"div":"core-blur"),null,{default:m(()=>[k(e.$slots,"default")]),_:3})),e.internalOptions.internal.siteAnalysis.connectToken?g("",!0):(c(),p("div",Y,[r("a",{href:"#",onClick:o[0]||(o[0]=N(f=>i.openPopup(e.$aioseo.urls.connect),["prevent"]))},n(e.connectWithAioseo),1),y(" "+n(u.strings.toAnalyzeCompetitorSite),1)]))]),_:3}),e.internalOptions.internal.siteAnalysis.connectToken?k(e.$slots,"competitor-results",{key:0}):g("",!0)])}const Q=v(J,[["render",K]]);const X={setup(){const{strings:e}=z();return{composableStrings:e}},components:{CoreSiteScore:j,SvgRefresh:H},mixins:[A],props:{score:Number,loading:Boolean,site:{type:String,required:!0},summary:{type:Object,default(){return{}}},mobileSnapshot:String},data(){return{isAnalyzing:!1,strings:R(this.composableStrings,{criticalIssues:this.$t.__("Important Issues",this.$td),warnings:this.$t.__("Warnings",this.$td),recommendedImprovements:this.$t.__("Recommended Improvements",this.$td),goodResults:this.$t.__("Good Results",this.$td),completeSiteAuditChecklist:this.$t.__("Complete Site Audit Checklist",this.$td),refreshResults:this.$t.__("Refresh Results",this.$td),mobileSnapshot:this.$t.__("Mobile Snapshot",this.$td)})}},methods:{...S(["runSiteAnalyzer","deleteCompetitorSite"]),refresh(){this.isAnalyzing=!0,this.runSiteAnalyzer({url:this.site,refresh:!0}).then(()=>this.isAnalyzing=!1)}}},Z={class:"aioseo-site-score-competitor"},ee={class:"aioseo-seo-site-score-score"},te={class:"aioseo-seo-site-score-recommendations"},se={class:"critical"},oe={class:"round red"},re={class:"recommended"},ie={class:"round blue"},ne={class:"good"},ae={class:"round green"},le={key:0,class:"mobile-snapshot"},ce=["src"];function me(e,o,s,u,t,i){const d=a("core-site-score"),f=a("svg-refresh"),C=a("base-button");return c(),p("div",Z,[r("div",ee,[l(d,{loading:t.isAnalyzing||s.loading,score:s.score,description:e.description},null,8,["loading","score","description"])]),r("div",te,[r("div",se,[r("span",oe,n(s.summary.critical||0),1),y(" "+n(t.strings.criticalIssues),1)]),r("div",re,[r("span",ie,n(s.summary.recommended||0),1),y(" "+n(t.strings.recommendedImprovements),1)]),r("div",ne,[r("span",ae,n(s.summary.good||0),1),y(" "+n(t.strings.goodResults),1)])]),l(C,{class:"refresh-results",type:"gray",size:"small",onClick:i.refresh,loading:t.isAnalyzing},{default:m(()=>[l(f),y(" "+n(t.strings.refreshResults),1)]),_:1},8,["onClick","loading"]),s.mobileSnapshot?(c(),p("div",le,[r("div",null,n(t.strings.mobileSnapshot),1),r("img",{alt:"Mobile Snapshot",src:s.mobileSnapshot},null,8,ce)])):g("",!0)])}const pe=v(X,[["render",me]]);const ue={setup(){const{strings:e}=z();return{composableStrings:e}},components:{CoreAnalyze:P,CoreAnalyzeScore:V,CoreAnalyzeCompetitorSiteHeader:Q,CoreCard:T,CoreSeoSiteAnalysisResults:W,CoreSiteScoreCompetitor:pe,SvgTrash:q},mixins:[A],data(){return{score:0,competitorUrl:null,isAnalyzing:!1,inputError:!1,competitorResults:{},analyzeTime:8,strings:R(this.composableStrings,{enterCompetitorUrl:this.$t.__("Enter Competitor URL",this.$td),performInDepthAnalysis:this.$t.__("Perform in-depth SEO Analysis of your competitor's website.",this.$td),analyze:this.$t.__("Analyze",this.$td),pleaseEnterValidUrl:this.$t.__("Please enter a valid URL.",this.$td)})}},watch:{analyzeError(e){e&&(this.isAnalyzing=!1)}},computed:{...b(["options","analyzer","analyzing","analyzeError"]),...I(["getCompetitorSiteAnalysisResults","goodCount","recommendedCount","criticalCount"]),getError(){switch(this.analyzeError){case"invalid-url":return this.$t.__("The URL provided is invalid.",this.$td);case"missing-content":return this.$t.sprintf("%1$s %2$s",this.$t.__("We were unable to parse the content for this site.",this.$td),this.$links.getDocLink(this.$constants.GLOBAL_STRINGS.learnMore,"seoAnalyzerIssues",!0));case"invalid-token":return this.$t.sprintf(this.$t.__("Your site is not connected. Please connect to %1$s, then try again.",this.$td),"AIOSEO")}return this.analyzeError}},methods:{...S(["runSiteAnalyzer","deleteCompetitorSite","saveConnectToken"]),...L(["toggleCard","closeCard"]),parseResults(e){return JSON.parse(e)},getSummary(e){return{recommended:this.recommendedCount(e),critical:this.criticalCount(e),good:this.goodCount(e)}},startAnalyzing(e){if(this.inputError=!1,this.competitorUrl=e.replace("http://","https://"),this.competitorUrl.startsWith("https://")||(this.competitorUrl="https://"+this.competitorUrl),!x(this.competitorUrl)){this.inputError=!0;return}this.$store.commit("analyzing",!0),this.$store.commit("analyzeError",!1),this.runSiteAnalyzer({url:this.competitorUrl}),this.isAnalyzing=!0,setTimeout(this.checkStatus,this.analyzeTime*1e3),this.closeAllCards()},checkStatus(){if(this.isAnalyzing=!1,this.analyzing){this.$nextTick(()=>{this.isAnalyzing=!0,2>this.analyzeTime&&(this.analyzeTime=8),this.analyzeTime=this.analyzeTime/2,setTimeout(this.checkStatus,this.analyzeTime*1e3)});return}this.competitorUrl=null,this.competitorResults=this.getCompetitorSiteAnalysisResults,this.toggleFirstCard(),this.$nextTick(()=>{const e=Object.keys(this.competitorResults),o=document.querySelector(".aioseo-header"),s=o.offsetHeight+o.offsetTop+30;this.$scrollTo("#aioseo-competitor-results"+this.hashCode(e[0]),{offset:-s})})},startDeleteSite(e){this.closeAllCards(),delete this.competitorResults[e],this.deleteCompetitorSite(e).then(()=>{this.competitorResults=this.getCompetitorSiteAnalysisResults})},closeAllCards(){Object.keys(this.competitorResults).forEach(o=>{this.closeCard("analyzeCompetitorSite"+o)})},toggleFirstCard(){const e=Object.keys(this.competitorResults);this.toggleCard("analyzeCompetitorSite"+e[0])},hashCode(e){if(!e)return;let o=0,s,u;for(s=0;s<e.length;s++)u=e.charCodeAt(s),o=(o<<5)-o+u,o|=0;return o}},mounted(){this.$store.commit("analyzeError",!1),this.competitorResults=this.getCompetitorSiteAnalysisResults,this.toggleFirstCard()}},he={class:"aioseo-analyze-competitor-site"},de={key:0,class:"aioseo-description aioseo-error"},_e=["innerHTML"],ye={class:"competitor-results-main"},ge={class:"competitor-results-body"};function fe(e,o,s,u,t,i){const d=a("core-analyze"),f=a("core-analyze-score"),C=a("svg-trash"),E=a("core-site-score-competitor"),U=a("core-seo-site-analysis-results"),O=a("core-card"),w=a("core-analyze-competitor-site-header");return c(),p("div",he,[l(w,null,{"competitor-results":m(()=>[(c(!0),p(B,null,M(t.competitorResults,(_,h)=>(c(),$(O,{key:h,id:"aioseo-competitor-results"+i.hashCode(h),slug:"analyzeCompetitorSite"+h,"save-toggle-status":!1},{header:m(()=>[l(f,{score:i.parseResults(_).score},null,8,["score"]),r("span",null,n(h),1),l(C,{onClick:Ce=>i.startDeleteSite(h)},null,8,["onClick"])]),default:m(()=>[r("div",ye,[l(E,{site:h,score:i.parseResults(_).score,loading:e.analyzing,summary:i.getSummary(i.parseResults(_).results),"mobile-snapshot":i.parseResults(_).results.advanced.mobileSnapshot},null,8,["site","score","loading","summary","mobile-snapshot"]),r("div",ge,[l(U,{section:"all-items","all-results":i.parseResults(_).results,"show-google-preview":""},null,8,["all-results"])])])]),_:2},1032,["id","slug"]))),128))]),default:m(()=>[l(d,{header:t.strings.enterCompetitorUrl,description:t.strings.performInDepthAnalysis,inputError:t.inputError,isAnalyzing:t.isAnalyzing,analyzeTime:t.analyzeTime,placeholder:"https://competitorwebsite.com",onStartAnalyzing:i.startAnalyzing},{errors:m(()=>[t.inputError?(c(),p("div",de,n(t.strings.pleaseEnterValidUrl),1)):g("",!0),e.analyzer==="competitor-site"&&e.analyzeError?(c(),p("div",{key:1,class:"analyze-errors aioseo-description aioseo-error",innerHTML:e.analyzeError},null,8,_e)):g("",!0)]),_:1},8,["header","description","inputError","isAnalyzing","analyzeTime","onStartAnalyzing"])]),_:1})])}const et=v(ue,[["render",fe]]);export{et as default};
